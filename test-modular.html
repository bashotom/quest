<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamischer Fragebogen - Test</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-scale@4"></script>
    
    <!-- Chart Library -->
    <script src="js/radarChart.js"></script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
            margin: 0;
            padding: 2rem;
        }
    </style>
</head>
<body>
    <div style="max-width: 1200px; margin: 0 auto;">
        <h1>WebComponent Test</h1>
        
        <div id="debug" style="background: #f3f4f6; padding: 1rem; margin-bottom: 2rem; border-radius: 0.5rem;">
            <h3>Debug Information:</h3>
            <ul id="debug-list"></ul>
        </div>
        
        <questionnaire-app id="main-app"></questionnaire-app>
    </div>

    <script type="module">
        const debugList = document.getElementById('debug-list');
        
        function addDebug(message) {
            const li = document.createElement('li');
            li.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            debugList.appendChild(li);
            console.log(message);
        }
        
        addDebug('Starting application...');
        
        // Check dependencies
        addDebug(`D3 available: ${typeof d3 !== 'undefined'}`);
        addDebug(`RadarChart available: ${typeof window.RadarChart === 'function'}`);
        addDebug(`Custom Elements supported: ${'customElements' in window}`);
        
        try {
            addDebug('Loading WebComponents...');
            
            const loadPromise = Promise.all([
                import('./components/questionnaire-app.js'),
                import('./components/questionnaire-form.js')
            ]);
            
            loadPromise.then(() => {
                addDebug('WebComponents loaded successfully');
                
                customElements.whenDefined('questionnaire-app').then(() => {
                    addDebug('questionnaire-app defined');
                    const app = document.getElementById('main-app');
                    addDebug(`App element found: ${!!app}`);
                });
                
            }).catch(error => {
                addDebug(`Error loading components: ${error.message}`);
                console.error('Component loading error:', error);
            });
            
        } catch (error) {
            addDebug(`JavaScript error: ${error.message}`);
            console.error('JavaScript error:', error);
        }
        
        // Global error handlers
        window.addEventListener('error', (event) => {
            addDebug(`Global error: ${event.error?.message || event.message}`);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            addDebug(`Unhandled promise rejection: ${event.reason}`);
        });
    </script>
</body>
</html>
